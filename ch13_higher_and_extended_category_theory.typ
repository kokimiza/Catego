#import "@preview/theorion:0.4.1": *
#import cosmos.clouds: *
#show: show-theorion

本章では、圏論の最前線である高次圏論と拡張圏論を体系的に展開する。これらの理論は、20世紀後半から21世紀にかけて発展した現代数学の最も抽象的かつ統一的な枠組みであり、代数的位相幾何学、代数幾何学、数理物理学、計算機科学における深遠な問題の解決に不可欠な道具となっている。#footnote[高次圏論の発展は、1960年代のBénabou による双圏の導入に始まり、1980年代のStreet, Kelly らによる2-圏論の発展、1990年代のBaez-Dolan による n-圏の概念、そして2000年代のLurie による∞-圏論の確立という段階を経ている。] 本章の目標は、読者を圏論研究の最前線へと導くことにある。

== 2-圏と双圏：射の間の射

通常の圏では、対象間の射のみを考察するが、2-圏では射の間にさらに高次の射（2-射）を導入する。この概念は、自然変換の一般化として自然に現れる。#footnote[2-圏の概念は、Charles Ehresmann が1963年に導入した。彼は代数的位相幾何学における基本群胞体の研究から、高次の射の必要性を認識した。]

#definition(title: "2-圏 (2-Category)")[
  *2-圏* $cal(C)$ は以下のデータからなる：
  - 0-細胞（対象）の集合 $op("ob")(cal(C))$
  - 各 $A, B in op("ob")(cal(C))$ に対する1-細胞の圏 $cal(C)(A, B)$
  - 水平合成関手 $compose_H: cal(C)(B, C) times cal(C)(A, B) -> cal(C)(A, C)$
  - 恒等1-細胞 $1_A in cal(C)(A, A)$

  これらは以下の公理を満たす：
  1. *結合律*: $(h compose_H g) compose_H f = h compose_H (g compose_H f)$
  2. *単位律*: $1_B compose_H f = f = f compose_H 1_A$ （$f: A -> B$）
  3. *交換律*: 垂直合成と水平合成の整合性
]

#theorem(title: "Mac Lane のコヒーレンス定理（2-圏版）")[
  2-圏において、結合子と単位子のみから構成される任意の2つの2-射が等しいならば、それらは実際に等しい。#footnote[この定理は、Mac Lane の1963年の古典的コヒーレンス定理を2-圏に拡張したものである。証明の技法は、書き換え理論（rewriting theory）と密接に関連している。]
]

#proof[
  証明は通常の圏におけるコヒーレンス定理の高次版である。2-射の標準形への書き換え規則を定義し、Church-Rosser性を示すことで完了する。詳細は Kelly [1982] を参照。#footnote[Max Kelly の "Basic concepts of enriched category theory" (1982) は、豊穣圏論と2-圏論の基礎を築いた記念碑的著作である。現在でも高次圏論の標準的参考文献として用いられている。]
]

=== 双圏の構造

双圏は2-圏の弱化版であり、結合律と単位律が同型まででのみ成り立つ。#footnote[双圏の概念は Jean Bénabou が1967年に導入した。彼は代数幾何学におけるスキームの研究から、厳密でない高次構造の必要性を認識した。双圏は現在、ホモトピー論や代数的K理論において中心的役割を果たしている。]

#definition(title: "双圏 (Bicategory)")[
  双圏 $cal(B)$ は2-圏のデータに加えて、以下の構造射を持つ：
  - 結合子 $alpha_(f,g,h): (h compose g) compose f -> h compose (g compose f)$
  - 左単位子 $lambda_f: 1 compose f -> f$
  - 右単位子 $rho_f: f compose 1 -> f$

  これらは Mac Lane の五角形等式と三角形等式を満たす。
]

#example(title: "重要な双圏の例")[
  1. *Span*: 対象を集合とし、1-射をspan、2-射をspanの射とする双圏#footnote[Span双圏は、関係データベース理論や量子力学の数学的基礎において重要な役割を果たす。特に、Coecke-Paquette による量子情報理論の圏論的定式化で中心的である。]
  2. *Prof*: 小圏を対象とし、プロファンクターを1-射とする双圏#footnote[プロファンクター双圏は、Lawvere の関係理論や Freyd の allegory 理論の一般化として理解される。現在では、型理論や計算機科学における関係的意味論の基礎となっている。]
  3. *Mod*: 環を対象とし、双加群を1-射とする双圏#footnote[双加群の双圏は、代数的K理論や非可換幾何学において基本的な役割を果たす。特に、Connes の非可換微分幾何学では、この構造が中心的である。]
]

== 自然変換の高次化

2-圏の枠組みにおいて、自然変換は新たな解釈を得る。#footnote[この解釈は、Eilenberg-Mac Lane の元々の自然変換の定義が、実は2-圏的構造を暗黙に仮定していたことを明らかにする。Gray の1974年の研究により、この関係が明確化された。]

#theorem(title: "自然変換の2-圏的特徴づけ")[
  関手 $F, G: cal(C) -> cal(D)$ 間の自然変換は、関手圏 $[cal(C), cal(D)]$ における1-射 $F$ から $G$ への2-射と一対一対応する。
]

この観点から、自然変換の「自然性」は2-圏における2-射の合成則として理解される。

#definition(title: "修正 (Modification)")[
  2-自然変換 $alpha, beta: F => G$ 間の *修正* $Gamma: alpha -> beta$ は、各対象 $X$ に対して2-射 $Gamma_X: alpha_X -> beta_X$ を割り当て、適切な整合性条件を満たすものである。#footnote[修正の概念は、Gordon-Power-Street (1995) によって体系化された。これは3-圏への自然な拡張を可能にし、高次圏論の発展において重要な役割を果たした。]
]

修正の概念により、3-圏への道筋が開かれる。

== Kan拡張：普遍的構成の極致

Kan拡張は圏論における最も一般的な普遍的構成であり、極限・余極限、随伴関手、米田の補題などを統一的に記述する。#footnote[Daniel Kan が1958年に導入したこの概念は、当初は単体的集合のホモトピー論における技術的道具であった。しかし、Mac Lane (1971) により圏論の中心概念として認識され、現在では「圏論における最も重要な概念の一つ」とされている。]

#definition(title: "左Kan拡張 (Left Kan Extension)")[
  関手 $F: cal(C) -> cal(D)$ と $K: cal(C) -> cal(E)$ に対し、$F$ の $K$ に沿った *左Kan拡張* $op("Lan")_K F: cal(E) -> cal(D)$ は、以下の普遍性によって特徴づけられる：

  任意の関手 $G: cal(E) -> cal(D)$ と自然変換 $alpha: F -> G compose K$ に対し、一意の自然変換 $beta: op("Lan")_K F -> G$ が存在して、
  $ alpha = beta K compose eta $
  ここで $eta: F -> op("Lan")_K F compose K$ は単位である。
]

#theorem(title: "Kan拡張の存在定理")[
  $cal(D)$ が余完備ならば、任意の $F: cal(C) -> cal(D)$ と $K: cal(C) -> cal(E)$ に対して左Kan拡張が存在する。具体的には、
  $ (op("Lan")_K F)(E) = op("colim")_(K/E) F compose pi $
  ここで $K/E$ は $K$ 上の $E$ のコンマ圏、$pi: K/E -> cal(C)$ は射影関手である。#footnote[この公式は「余端公式」(coend formula) とも呼ばれ、$integral^(C in cal(C)) cal(E)(K(C), E) times F(C)$ として表現される。共端の理論は、Eilenberg-Kelly (1966) によって発展され、現在では圏論の基本的道具となっている。]
]

#corollary(title: "米田の補題の一般化")[
  米田埋め込み $yen: cal(C) -> [cal(C)^op, bold("Set")]$ について、任意の前層 $P$ に対し、
  $ op("Lan")_yen P approx P $
  が成り立つ。これは米田の補題の圏論的本質を表している。#footnote[この結果は、米田の補題が実はKan拡張の特殊例であることを示している。より一般に、任意の充満忠実関手に沿ったKan拡張は恒等関手となる。この観察は、Day (1970) による畳み込み積の理論の基礎となった。]
]

=== 右Kan拡張と随伴性

#theorem(title: "Kan拡張と随伴関手")[
  関手 $K: cal(C) -> cal(E)$ について、以下は同値である：
  1. $K$ が左随伴を持つ
  2. 任意の $F: cal(C) -> cal(D)$ に対して $op("Lan")_K F$ が存在し、$op("Lan")_K$ が関手 $[cal(C), cal(D)] -> [cal(E), cal(D)]$ を定める
  3. $K$ は余完備性を保存する
]

== コンマ圏：構造の分解

コンマ圏は、射の分解や普遍的性質の記述において中心的役割を果たす。#footnote[コンマ圏は、Lawvere が1963年の博士論文で導入した。当初は代数理論の研究のための技術的道具であったが、現在では圏論における最も基本的な構成の一つとなっている。]

#definition(title: "コンマ圏 (Comma Category)")[
  関手 $F: cal(A) -> cal(C)$, $G: cal(B) -> cal(C)$ に対し、コンマ圏 $(F arrow.b G)$ は以下で定義される：
  - 対象：三つ組 $(A, B, f)$ ただし $A in cal(A)$, $B in cal(B)$, $f: F(A) -> G(B)$
  - 射：$(A, B, f) -> (A', B', f')$ は対 $(alpha, beta)$ ただし $alpha: A -> A'$, $beta: B -> B'$ で $G(beta) compose f = f' compose F(alpha)$
]

#theorem(title: "コンマ圏の普遍性")[
  コンマ圏 $(F arrow.b G)$ は、図式
  $ cal(A) arrow.r^F cal(C) arrow.l_G cal(B) $
  の引き戻しを2-圏 $bold("Cat")$ において計算したものである。
]

=== 極限のコンマ圏による記述

#theorem(title: "極限の統一的記述")[
  図式 $D: cal(J) -> cal(C)$ の極限は、コンマ圏 $(Delta arrow.b D)$ の終対象として特徴づけられる。ここで $Delta: cal(C) -> [cal(J), cal(C)]$ は対角関手である。#footnote[この特徴づけは、Street (1972) によって明確化された。これにより、すべての極限概念が統一的に理解され、極限の存在問題が終対象の存在問題に帰着される。]
]

この定理により、すべての極限概念がコンマ圏の言葉で統一的に記述される。

== プロファンクター：関係の圏論

プロファンクターは、関手の概念を「関係」の方向に一般化したものである。#footnote[プロファンクターの概念は、Lawvere (1973) と Bénabou (1973) によって独立に導入された。Lawvere は「distributor」、Bénabou は「profunctor」と呼んだ。現在では後者の用語が一般的である。]

#definition(title: "プロファンクター (Profunctor)")[
  圏 $cal(C)$, $cal(D)$ 間の *プロファンクター* $H: cal(C) arrow.r.squiggly cal(D)$ は、関手 $H: cal(D)^op times cal(C) -> bold("Set")$ である。
]

プロファンクターの合成は、共端公式（coend formula）によって定義される：
$ (K compose H)(D, C) = integral^(X in cal(E)) K(D, X) times H(X, C) $#footnote[この合成は、関係の合成の圏論的一般化である。共端による定義は、Day (1970) によって体系化され、現在では豊穣圏論や高次圏論において標準的な技法となっている。]

#theorem(title: "プロファンクターの双圏")[
  小圏を0-細胞、プロファンクターを1-細胞、プロファンクター間の自然変換を2-細胞とする双圏 $bold("Prof")$ が構成される。
]

#theorem(title: "Cauchy完備化")[
  任意の小圏 $cal(C)$ に対し、その *Cauchy完備化* $hat(cal(C))$ が存在し、$cal(C) -> hat(cal(C))$ は充満忠実である。$hat(cal(C))$ は冪等射が分裂する最小の圏である。#footnote[Cauchy完備化は、Lawvere (1973) によって導入され、Carboni-Walters (1987) によって詳細に研究された。これは、圏論における「完備化」の概念の重要な例であり、代数的K理論や非可換幾何学において基本的役割を果たす。]
]

== レンズ圏：光学系の圏論

レンズ圏は、関数型プログラミングにおけるレンズの概念を圏論的に定式化したものである。#footnote[レンズの概念は、Haskell コミュニティで発展し、O'Connor (2011) によって圏論的に定式化された。その後、Riley (2018) によってより一般的な光学系（optics）の理論として発展した。これは、計算機科学と圏論の相互作用の優れた例である。]

#definition(title: "レンズ圏 (Lens Category)")[
  モノイダル圏 $cal(C)$ 上のレンズ圏 $bold("Lens")(cal(C))$ は以下で定義される：
  - 対象：$cal(C)$ の対象
  - 射 $A -> B$：対 $("get", "put")$ ただし
    - $"get": A -> B times.o.big R$（何らかの残余 $R$ と共に）
    - $"put": A times.o.big B -> A$
  - 合成：レンズ則を満たす適切な合成
]

#theorem(title: "レンズ則")[
  レンズ $("get", "put"): A -> B$ は以下の法則を満たす：
  1. *GetPut*: $"put"(a, pi_1("get"(a))) = a$
  2. *PutGet*: $pi_1("get"("put"(a, b))) = b$
  3. *PutPut*: $"put"("put"(a, b), c) = "put"(a, c)$#footnote[これらの法則は、データ構造の更新操作の一貫性を保証する。GetPut は「変更しない更新は恒等」、PutGet は「更新後の取得は更新値」、PutPut は「連続更新の結合律」を表現している。]
]

== Dagger圏：量子論理の圏論

Dagger圏は、量子力学や線形代数における随伴の概念を圏論的に抽象化したものである。#footnote[Dagger圏の概念は、Selinger (2007) によって量子計算の圏論的モデルとして導入された。その後、Abramsky-Coecke (2004) による量子情報理論の圏論的基礎や、Heunen-Vicary (2019) による量子理論の圏論的定式化において中心的役割を果たしている。]

#definition(title: "Dagger圏 (Dagger Category)")[
  圏 $cal(C)$ が *dagger圏* であるとは、反変関手 $dagger: cal(C)^op -> cal(C)$ が存在し、以下を満たすことである：
  1. $f^(dagger dagger) = f$
  2. $(g compose f)^dagger = f^dagger compose g^dagger$
  3. $id_A^dagger = id_A$
]

#definition(title: "ユニタリ射")[
  Dagger圏において、射 $f: A -> B$ が *ユニタリ* であるとは、$f^dagger compose f = id_A$ かつ $f compose f^dagger = id_B$ が成り立つことである。
]

#theorem(title: "量子圏の構造")[
  有限次元ヒルベルト空間の圏 $bold("FHilb")$ は、テンソル積をモノイダル構造、随伴をdagger構造とするdaggerモノイダル圏である。#footnote[この構造は、量子力学の数学的基礎を圏論的に記述する。特に、量子もつれ、量子測定、量子チャネルなどの概念が、この圏の構造として自然に表現される。Coecke-Paquette-Perdrix (2008) による「量子絵算」はこの理論の重要な応用である。]
]

== ∞-圏：ホモトピー論的圏論

∞-圏は、圏論をホモトピー論的設定に拡張した理論である。#footnote[∞-圏の概念は、1980年代のBoardman-Vogt による「homotopy coherent diagrams」の研究に端を発し、1990年代のJoyal による準圏の導入、2000年代のLurie による体系的理論の構築を経て確立された。現在では、代数的位相幾何学と代数幾何学の統一的理解において不可欠な道具となっている。]

#definition(title: "準圏 (Quasicategory)")[
  単体集合 $X$ が *準圏* であるとは、すべての $0 < i < n$ に対して、内角 $Lambda^n_i -> Delta^n$ から $X$ への写像が $Delta^n -> X$ に拡張できることである。#footnote[準圏は、Boardman-Vogt (1973) によって導入された「homotopy coherent nerve」の概念を、Joyal (2002) が単体的手法で再定式化したものである。これは∞-圏の最も扱いやすいモデルの一つとなっている。]
]

準圏は∞-圏の最も重要なモデルの一つである。

#theorem(title: "∞-圏の米田の補題")[
  ∞-圏 $cal(C)$ に対し、米田埋め込み $yen: cal(C) -> bold("Fun")(cal(C)^op, cal(S))$ は充満忠実である。ここで $cal(S)$ は空間の∞-圏である。#footnote[この定理は、Lurie (2009) の "Higher Topos Theory" において証明された。古典的な米田の補題の∞-圏版であり、∞-圏論における最も基本的な結果の一つである。]
]

#definition(title: "∞-トポス")[
  ∞-圏 $cal(X)$ が *∞-トポス* であるとは、以下の条件を満たすことである：
  1. 有限極限を持つ
  2. 余完備である
  3. 小さな生成子を持つ
  4. 降下条件を満たす
]

#theorem(title: "Lurie の定理")[
  ∞-トポスの圏は、Grothendieckトポスの圏のホモトピー論的一般化である。具体的には、∞-トポスは適切な∞-サイト上の層の∞-圏として実現される。#footnote[この定理は、Lurie の "Higher Topos Theory" (2009) の主要結果である。これにより、Grothendieck の層理論とトポス理論が、ホモトピー論的設定において完全に一般化されることが示された。現在では、導来代数幾何学や motivic homotopy theory の基礎となっている。]
]

== 導来代数幾何学への応用

∞-圏論の最も重要な応用の一つが、Lurie-Toën-Vezzosi による導来代数幾何学である。#footnote[導来代数幾何学は、Quillen (1967) による導来関手の理論と、Deligne-Illusie (1987) による結晶コホモロジーの研究を出発点とし、Toën-Vezzosi (2008) と Lurie (2011) によって∞-圏論的に定式化された。これは、代数幾何学における特異点の問題や、数論幾何学における深い問題の解決において革命的な進展をもたらしている。]

#definition(title: "導来スキーム")[
  *導来スキーム* は、可換微分次数環のスペクトラムとして定義される∞-スタックである。#footnote[導来スキームの概念は、古典的なスキーム理論を「ホモトピー論的に正しい」方向に拡張したものである。これにより、交叉理論や変形理論における多くの技術的困難が自然に解決される。]
]

#theorem(title: "導来代数幾何学の基本定理")[
  導来スキームの∞-圏は、以下の性質を持つ：
  1. 有限極限と任意の余極限を持つ
  2. 適切な∞-トポスを形成する
  3. 古典的代数幾何学を完全に含む
]

== 高次圏論の展望

高次圏論は現在も急速に発展している分野である。#footnote[高次圏論の現在の主要な研究方向には、(1) n-圏の厳密な定義と分類、(2) ∞-圏のモデル理論、(3) 高次トポス理論、(4) 導来代数幾何学への応用、(5) ホモトピー型理論との関係、などがある。特に、Voevodsky の一価性基礎 (Univalent Foundations) プログラムは、高次圏論と論理学の新たな接点を開いている。]

#definition(title: "n-圏の帰納的定義")[
  - 0-圏は集合である
  - $(n+1)$-圏は、射がn-圏である圏である
]

#conjecture(title: "Baez-Dolan予想")[
  n-圏の理論は、$(n-1)$-圏の理論から標準的に構成される。具体的には、n-圏は適切な$(n-1)$-圏豊穣圏として実現される。#footnote[この予想は、Baez-Dolan (1995) によって提出され、高次圏論の統一理論構築における中心的問題となっている。部分的な結果は得られているが、完全な証明は未だ得られていない。]
]

#theorem(title: "安定∞-圏の分類")[
  小さな安定∞-圏は、適切なスペクトラムの圏と同値である。これにより、ホモトピー論と圏論の深い関係が明らかになる。#footnote[この定理は、Lurie (2017) の "Higher Algebra" において証明された。これにより、安定ホモトピー論の圏論的基礎が確立され、代数的K理論や motivic homotopy theory における多くの問題が統一的に理解されるようになった。]
]

== 結論：圏論の未来

本章で展開した高次圏論と拡張圏論は、21世紀数学の中核的枠組みとなっている。これらの理論は以下の分野で革命的な進展をもたらしている：

1. *代数的位相幾何学*：安定ホモトピー論の圏論的定式化
2. *代数幾何学*：導来代数幾何学とmotivic homotopy theory
3. *数理物理学*：位相的場の理論と圏化
4. *計算機科学*：型理論とプログラム意味論
5. *論理学*：ホモトピー型理論と一価性公理

圏論は、Eilenberg-Mac Laneによる創始から80年を経て、数学の統一言語としての地位を確立した。高次圏論の発展により、この統一はさらに深化し、数学と物理学、計算機科学の境界を越えた新たな理解が生まれ続けている。#footnote[圏論の影響は、純粋数学にとどまらず、理論物理学（弦理論、場の量子論）、計算機科学（型理論、プログラム意味論）、認知科学（概念の形成理論）、さらには哲学（構造主義、数学の基礎論）にまで及んでいる。21世紀の知的活動において、圏論的思考は不可欠な道具となりつつある。]

読者諸氏が本書を通じて圏論の深遠な美しさと強力さを理解し、この理論の更なる発展に貢献されることを期待する。圏論の旅は、ここから始まるのである。#footnote[本書で扱った内容は、圏論の基礎的部分に過ぎない。より高度な話題として、高次代数的K理論、motivic homotopy theory、導来代数幾何学、ホモトピー型理論、量子場理論の圏論的定式化などが待っている。これらの分野は現在も活発に研究されており、新たな発見と理解が日々生まれている。]